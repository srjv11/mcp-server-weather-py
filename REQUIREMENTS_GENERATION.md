# Requirements File Generation

This project automatically generates `requirements.txt` and `requirements-dev.txt` files from `pyproject.toml` and `uv.lock` to enable GitHub's dependency graph and security features.

## 📋 Generated Files

### requirements.txt
- **Purpose**: Production dependencies only
- **Source**: Generated from `uv.lock` without development dependencies
- **Usage**: `pip install -r requirements.txt`
- **GitHub Integration**: Used for dependency graph and security alerts

### requirements-dev.txt
- **Purpose**: All dependencies including development tools
- **Source**: Generated from `uv.lock` with all dependency groups
- **Usage**: `pip install -r requirements-dev.txt`
- **Contains**: Testing, linting, formatting, and other dev tools

## 🔄 Automatic Generation

### GitHub Actions Workflow
The requirements files are automatically updated by `.github/workflows/update-requirements.yml`:

**Triggers:**
- Push to `main` branch when `pyproject.toml` or `uv.lock` changes
- Weekly schedule (Sundays at 2 AM UTC)
- Manual workflow dispatch

**Process:**
1. Install `uv` and Python 3.13
2. Export dependencies using `uv export`
3. Add informative headers to files
4. Commit changes if files have changed
5. Create PR for scheduled updates

## 🎯 Benefits

### GitHub Integration
- **Dependency Graph**: Visual representation of project dependencies
- **Security Alerts**: Automatic notifications for vulnerable dependencies
- **Dependabot**: Automated dependency update pull requests
- **License Detection**: Automatic license compliance checking

### Compatibility
- **pip Users**: Can install project using standard `pip install -r requirements.txt`
- **CI/CD**: Compatible with systems that don't support `uv` or `pyproject.toml`
- **Docker**: Can use requirements files in Dockerfile for better layer caching

## 📝 File Format

### Header Information
Both files include informative headers:
```
# This file is auto-generated from pyproject.toml and uv.lock
# Do not edit manually - it will be overwritten
# Generated by: .github/workflows/update-requirements.yml
# Last updated: YYYY-MM-DD
```

### Dependency Format
```
package-name==1.2.3
    # via dependency-that-requires-it
```

## 🛠️ Manual Generation

### Generate Production Requirements
```bash
# Production dependencies only
uv export --format requirements-txt --no-hashes --no-dev > requirements.txt
```

### Generate Development Requirements
```bash
# All dependencies including dev tools
uv export --format requirements-txt --no-hashes > requirements-dev.txt
```

### Verify Generated Files
```bash
# Test production installation
pip install -r requirements.txt

# Test development installation
pip install -r requirements-dev.txt
```

## 🔧 Configuration

### Customizing Export Options
Modify the workflow to change export behavior:

```yaml
# Add/remove flags as needed
uv export --format requirements-txt --no-hashes --no-dev > requirements.txt
```

**Available options:**
- `--no-hashes`: Remove package hashes (recommended for GitHub)
- `--no-dev`: Exclude development dependencies
- `--no-editable`: Convert editable installs to regular installs
- `--frozen`: Use exact versions from lockfile

### Workflow Scheduling
Change the schedule in the workflow file:
```yaml
schedule:
  # Run daily at midnight UTC
  - cron: '0 0 * * *'

  # Run on first day of each month
  - cron: '0 0 1 * *'
```

## 🚨 Important Notes

### Do Not Edit Manually
- Files are automatically regenerated
- Manual changes will be lost
- Edit `pyproject.toml` instead for dependency changes

### Version Control
- Both files are tracked in git
- Changes trigger automatic commits
- Scheduled updates create pull requests

### Dependency Updates
1. **Update pyproject.toml** with new dependencies
2. **Run `uv sync`** to update lockfile
3. **Push changes** to trigger requirements update
4. **GitHub workflow** automatically updates requirements files

## 🔍 Troubleshooting

### Requirements Not Updated
- Check if `uv.lock` file has changed
- Verify workflow has write permissions
- Review GitHub Actions logs for errors

### Dependency Graph Issues
- Ensure `requirements.txt` is in repository root
- Check file format is valid pip requirements format
- Verify GitHub dependency graph is enabled in repository settings

### Installation Failures
- Compare `requirements.txt` with `uv.lock` for discrepancies
- Test installation in clean environment
- Check for platform-specific dependencies

## 📊 GitHub Dependency Features

### Enabling Dependency Graph
1. Go to repository **Settings**
2. Navigate to **Security & analysis**
3. Enable **Dependency graph**
4. Enable **Dependabot alerts**

### Viewing Dependencies
- Visit **Insights** → **Dependency graph**
- See dependency tree and vulnerabilities
- Review Dependabot alerts in **Security** tab

---

**Requirements Generation** - Automated dependency management for GitHub integration 📦
